// partial_specialization_of_class_templates2.cpp
// compile with: /EHsc
#include <iostream>
using namespace std;

// Original template collection class.
template <class T> class Bag {
   T* elem;
   int size;
   int max_size;

public:
   Bag() : elem(0), size(0), max_size(1) {}
   void add(T t) {
      T* tmp;
      if (size + 1 >= max_size) {
         max_size *= 2;
         tmp = new T [max_size];
         for (int i = 0; i < size; i++)
            tmp[i] = elem[i];
         tmp[size++] = t;
         delete[] elem;
         elem = tmp;
      }
      else
         elem[size++] = t;
   }

   void print() {
      for (int i = 0; i < size; i++)
         cout << elem[i] << " ";
      cout << endl;
   }
};

// Template partial specialization for pointer types.
// The collection has been modified to check for NULL
// and store types pointed to.
template <class T> class Bag<T*> {
   T* elem;
   int size;
   int max_size;

public:
   Bag() : elem(0), size(0), max_size(1) {}
   void add(T* t) {
      T* tmp;
      if (t == NULL) {   // Check for NULL
         cout << "Null pointer!" << endl;
         return;
      }

      if (size + 1 >= max_size) {
         max_size *= 2;
         tmp = new T [max_size];
         for (int i = 0; i < size; i++)
            tmp[i] = elem[i];
         tmp[size++] = *t;  // Dereference
         delete[] elem;
         elem = tmp;
      }
      else
         elem[size++] = *t; // Dereference
   }

   void print() {
      for (int i = 0; i < size; i++)
         cout << elem[i] << " ";
      cout << endl;
   }
};

int main() {
   Bag<int> xi;
   Bag<char> xc;
   Bag<int*> xp; // Uses partial specialization for pointer types.

   xi.add(10);
   xi.add(9);
   xi.add(8);
   xi.print();

   xc.add('a');
   xc.add('b');
   xc.add('c');
   xc.print();

   int i = 3, j = 87, *p = new int[2];
   *p = 8;
   *(p + 1) = 100;
   xp.add(&i);
   xp.add(&j);
   xp.add(p);
   xp.add(p + 1);
   delete[] p;
   p = NULL;
   xp.add(p);
   xp.print();
}
10 9 8
a b c
Null pointer!
3 87 8 100.features_enabled,host_name,dormant_users.dormancy_threshold,dormant_users.total_dormant_users,ghes_version,server_id,collection_date,schema_version,ghe_stats.comments.total_commit_comments,ghe_stats.comments.total_gist_comments,ghe_stats.comments.total_issue_comments,ghe_stats.comments.total_pull_request_comments,ghe_stats.gists.total_gists,ghe_stats.gists.private_gists,ghe_stats.gists.public_gists,ghe_stats.hooks.total_hooks,ghe_stats.hooks.active_hooks,ghe_stats.hooks.inactive_hooks,ghe_stats.issues.total_issues,ghe_stats.issues.open_issues,ghe_stats.issues.closed_issues,ghe_stats.milestones.total_milestones,ghe_stats.milestones.open_milestones,ghe_stats.milestones.closed_milestones,ghe_stats.orgs.total_orgs,ghe_stats.orgs.disabled_orgs,ghe_stats.orgs.total_teams,ghe_stats.orgs.total_team_members,ghe_stats.pages.total_pages,ghe_stats.pulls.total_pulls,ghe_stats.pulls.merged_pulls,ghe_stats.pulls.mergeable_pulls,ghe_stats.pulls.unmergeable_pulls,ghe_stats.repos.total_repos,ghe_stats.repos.root_repos,ghe_stats.repos.fork_repos,ghe_stats.repos.org_repos,ghe_stats.repos.total_pushes,ghe_stats.repos.total_wikis,ghe_stats.users.total_users,ghe_stats.users.admin_users,ghe_stats.users.suspended_users,actions_stats.number_of_repos_using_actions,actions_stats.percentage_of_repos_using_actions,packages_stats.registry_enabled,packages_stats.registry_v2_enabled,packages_stats.ecosystems.docker.registry_enabled,packages_stats.ecosystems.docker.published_packages_count,packages_stats.ecosystems.docker.private_packages_count,packages_stats.ecosystems.docker.public_packages_count,packages_stats.ecosystems.docker.internal_packages_count,packages_stats.ecosystems.docker.user_packages_count,packages_stats.ecosystems.docker.organization_packages_count,packages_stats.ecosystems.docker.daily_download_count,packages_stats.ecosystems.docker.daily_update_count,packages_stats.ecosystems.docker.daily_delete_count,packages_stats.ecosystems.docker.daily_create_count,packages_stats.ecosystems.maven.registry_enabled,packages_stats.ecosystems.maven.published_packages_count,packages_stats.ecosystems.maven.private_packages_count,packages_stats.ecosystems.maven.public_packages_count,packages_stats.ecosystems.maven.internal_packages_count,packages_stats.ecosystems.maven.user_packages_count,packages_stats.ecosystems.maven.organization_packages_count,packages_stats.ecosystems.maven.daily_download_count,packages_stats.ecosystems.maven.daily_update_count,packages_stats.ecosystems.maven.daily_delete_count,packages_stats.ecosystems.maven.daily_create_count,packages_stats.ecosystems.npm.registry_enabled,packages_stats.ecosystems.npm.published_packages_count,packages_stats.ecosystems.npm.private_packages_count,packages_stats.ecosystems.npm.public_packages_count,packages_stats.ecosystems.npm.internal_packages_count,packages_stats.ecosystems.npm.user_packages_count,packages_stats.ecosystems.npm.organization_packages_count,packages_stats.ecosystems.npm.daily_download_count,packages_stats.ecosystems.npm.daily_update_count,packages_stats.ecosystems.npm.daily_delete_count,packages_stats.ecosystems.npm.daily_create_count,packages_stats.ecosystems.nuget.registry_enabled,packages_stats.ecosystems.nuget.published_packages_count,packages_stats.ecosystems.nuget.private_packages_count,packages_stats.ecosystems.nuget.public_packages_count,packages_stats.ecosystems.nuget.internal_packages_count,packages_stats.ecosystems.nuget.user_packages_count,packages_stats.ecosystems.nuget.organization_packages_count,packages_stats.ecosystems.nuget.daily_download_count,packages_stats.ecosystems.nuget.daily_update_count,packages_stats.ecosystems.nuget.daily_delete_count,packages_stats.ecosystems.nuget.daily_create_count,packages_stats.ecosystems.ruby_gems.registry_enabled,packages_stats.ecosystems.ruby_gems.published_packages_count,packages_stats.ecosystems.ruby_gems.private_packages_count,packages_stats.ecosystems.ruby_gems.public_packages_count,packages_stats.ecosystems.ruby_gems.internal_packages_count,packages_stats.ecosystems.ruby_gems.user_packages_count,packages_stats.ecosystems.ruby_gems.organization_packages_count,packages_stats.ecosystems.ruby_gems.daily_download_count,packages_stats.ecosystems.ruby_gems.daily_update_count,packages_stats.ecosystems.ruby_gems.daily_delete_count,packages_stats.ecosystems.ruby_gems.daily_create_count,packages_stats.ecosystems.containers.registry_enabled,packages_stats.ecosystems.containers.published_packages_count,packages_stats.ecosystems.containers.private_packages_count,packages_stats.ecosystems.containers.public_packages_count,packages_stats.ecosystems.containers.internal_packages_count,packages_stats.ecosystems.containers.user_packages_count,packages_stats.ecosystems.containers.organization_packages_count,packages_stats.ecosystems.containers.daily_download_count,packages_stats.ecosystems.containers.daily_update_count,packages_stats.ecosystems.containers.daily_delete_count,packages_stats.ecosystems.containers.daily_create_count
feature1 feature2 feature3,notmymachine,90 days,5,9.99.9,deadbeef1,2023-04-05T00:00:00Z,20230306,1000,1000,0,0,100,59,41,3,2,1,3421,1234,1222,50,20,30,100,22,299,400,10,1232,223,435,0,12,1,2,1,42,1,2000,299,423,1,11.11,TRUE,TRUE,TRUE,21,22,23,24,25,26,27,28,29,30,readonly,11,12,13,14,15,16,17,18,19,20,TRUE,1,2,3,4,5,6,7,8,9,10,TRUE,31,32,33,34,35,36,37,38,39,40,TRUE,41,42,43,44,45,46,47,48,49,50,FALSE,51,52,53,54,55,56,57,58,59,60
